# Protection against DDoS attacks

# Limit request timeout to prevent slow connections
<IfModule mod_reqtimeout.c>
    RequestReadTimeout header=20-40,MinRate=500 body=20,MinRate=500
</IfModule>

# Configure mod_evasive to detect and block suspicious behavior
<IfModule mod_evasive20.c>
    # Maximum number of requests per second for the same resource
    DOSHashTableSize 2048
    DOSPageCount 20
    DOSSiteCount 100
    DOSPageInterval 1
    DOSSiteInterval 1
    DOSBlockingPeriod 10

    # Path to log detected attacks
    DOSEmailNotify youremail@example.com
    DOSLogDir "/var/log/apache2/mod_evasive"
    DOSWhitelist 127.0.0.1
</IfModule>

# Limit the number of simultaneous connections per IP address
<IfModule mod_limitipconn.c>
    MaxConnPerIP 10
</IfModule>

# Enable request size limits
LimitRequestBody 10485760
LimitRequestFields 100
LimitRequestFieldSize 8190